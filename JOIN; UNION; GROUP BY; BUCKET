-- Left semi joins



-- Union 
-- If variables are not matching in two dataset, the UNION function will return an error

-- https://cwiki.apache.org/confluence/display/Hive/LanguageManual+GroupBy
-- Count the unique stock number
SELECT count(DISTINCT symbol) FROM daily;

-- Find each stock's average close price per year
SELECT low(symbol), year(ymd), avg(close) FROM daily 
WHERE 
Group by symbol, year(ymd);

-- Find average close price per year
SELECT year(ymd), avg(close) FROM daily 
WHERE 
Group by year(ymd);
